"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[7616],{3905:function(e,n,a){a.d(n,{Zo:function(){return s},kt:function(){return m}});var t=a(7294);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function l(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,i=function(e,n){if(null==e)return{};var a,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var p=t.createContext({}),u=function(e){var n=t.useContext(p),a=n;return e&&(a="function"==typeof e?e(n):l(l({},n),e)),a},s=function(e){var n=u(e.components);return t.createElement(p.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var a=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),d=u(a),m=i,v=d["".concat(p,".").concat(m)]||d[m]||c[m]||r;return a?t.createElement(v,l(l({ref:n},s),{},{components:a})):t.createElement(v,l({ref:n},s))}));function m(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=d;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var u=2;u<r;u++)l[u]=a[u];return t.createElement.apply(null,l)}return t.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5373:function(e,n,a){a.r(n),a.d(n,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return u},toc:function(){return s},default:function(){return d}});var t=a(7462),i=a(3366),r=(a(7294),a(3905)),l=["components"],o={},p="API et librairie Angular",u={unversionedId:"kivala/api-et-lib-angular",id:"kivala/api-et-lib-angular",title:"API et librairie Angular",description:"Build",source:"@site/docs/kivala/api-et-lib-angular.md",sourceDirName:"kivala",slug:"/kivala/api-et-lib-angular",permalink:"/my-docs/docs/kivala/api-et-lib-angular",editUrl:"https://github.com/Kenny-54/my-docs/tree/main/docs/kivala/api-et-lib-angular.md",tags:[],version:"current",frontMatter:{},sidebar:"kivalaSidebar",previous:{title:"Description",permalink:"/my-docs/docs/kivala"},next:{title:"Documentation technique",permalink:"/my-docs/docs/kivala/doc-technique"}},s=[{value:"Build",id:"build",children:[],level:2},{value:"Packaging",id:"packaging",children:[],level:2},{value:"Installation de la librairie",id:"installation-de-la-librairie",children:[],level:2},{value:"Mise \xe0 jour de la libraire",id:"mise-\xe0-jour-de-la-libraire",children:[],level:2},{value:"Mise en place dans l\u2019application",id:"mise-en-place-dans-lapplication",children:[{value:"Dans app.module.ts",id:"dans-appmodulets",children:[],level:3},{value:"Param\xe8tres",id:"param\xe8tres",children:[],level:3},{value:"Protection des routes",id:"protection-des-routes",children:[],level:3},{value:"Page de connexion",id:"page-de-connexion",children:[],level:3}],level:2}],c={toc:s};function d(e){var n=e.components,a=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,t.Z)({},c,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"api-et-librairie-angular"},"API et librairie Angular"),(0,r.kt)("h1",{id:"librairie-kivala"},"Librairie Kivala"),(0,r.kt)("h2",{id:"build"},"Build"),(0,r.kt)("p",null,"A la racine du projet, lancer ",(0,r.kt)("inlineCode",{parentName:"p"},"ng build kivala")),(0,r.kt)("h2",{id:"packaging"},"Packaging"),(0,r.kt)("p",null,"A la racine du projet, lancer ",(0,r.kt)("inlineCode",{parentName:"p"},"npm pack dist\\kivala")," sous Windows ou ",(0,r.kt)("inlineCode",{parentName:"p"},"npm pack dist/kivala/")," sous Linux/MacOs"),(0,r.kt)("h1",{id:"testapp"},"Testapp"),(0,r.kt)("p",null,"Application permettant de tester la librairie Kivala."),(0,r.kt)("p",null,"Pour d\xe9bugger la librairie en m\xeame temps que l\u2019appli de test, lancer dans un terminal :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"ng build kivala --watch\n")),(0,r.kt)("p",null,"et dans un autre ex\xe9cuter l\u2019application de test"),(0,r.kt)("h1",{id:"dans-une-application-angular"},"Dans une application Angular"),(0,r.kt)("h2",{id:"installation-de-la-librairie"},"Installation de la librairie"),(0,r.kt)("p",null,'Copier le fichier cd54-kivala-x.x.x.tgz puis lancer (o\xf9 "x.x.x" est le n\xb0 de version)'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm i cd54-kivala-x.x.x.tgz\n")),(0,r.kt)("h2",{id:"mise-\xe0-jour-de-la-libraire"},"Mise \xe0 jour de la libraire"),(0,r.kt)("p",null,"Supprimer le fichier .tgz de l\u2019ancienne version et copier celui de la nouvelle version puis lancer "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm i cd54-kivala-x.x.x.tgz\n")),(0,r.kt)("h2",{id:"mise-en-place-dans-lapplication"},"Mise en place dans l\u2019application"),(0,r.kt)("h3",{id:"dans-appmodulets"},"Dans app.module.ts"),(0,r.kt)("p",null,"Dans l\u2019import du module, il faut fournir l\u2019URL de l\u2019API Kivala ainsi que le nom de l\u2019application"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"[...]\nimport { AuthInterceptor, AuthModule } from '@cd54/kivala';\nimport { environment } from '@core/environment'\n\n@NgModule({\n  declarations: [\n    AppComponent\n  ],\n  imports: [\n    [...]\n    AuthModule.forRoot(\n      environment.kivalaApiUrl,\n      environment.applicationName)    \n  })\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n")),(0,r.kt)("h3",{id:"param\xe8tres"},"Param\xe8tres"),(0,r.kt)("p",null,"Dans environment.ts"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"export const environment = {\n  [...]\n  applicationName: '<nom_de_l_appli>',\n  kivalaApiUrl : 'https://localhost:7285'\n};\n")),(0,r.kt)("h3",{id:"protection-des-routes"},"Protection des routes"),(0,r.kt)("p",null,"Dans app-routing.module.ts"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const authGuardData = {\n  loginUrl: '/login',\n  apiUrl: environment.kivalaApiUrl\n};\n\nconst routes: Routes = [\n  [...]\n  { path: 'log', loadChildren: () => import('./features/+log/log.module').then(m => m.LogModule), canActivate: [AuthGuard], data: authGuardData },\n];\n")),(0,r.kt)("h3",{id:"page-de-connexion"},"Page de connexion"),(0,r.kt)("p",null,"Cr\xe9er une page de connexion avec un formulaire contenant un champ pour le nom d\u2019utilisateur et le mot de passe."),(0,r.kt)("p",null,"La soumission du formulaire doit appeler la m\xe9thode ",(0,r.kt)("inlineCode",{parentName:"p"},"login")," du service ",(0,r.kt)("inlineCode",{parentName:"p"},"LoginService")," (inclus dans la librairie) en lui fournissant un objet de type ",(0,r.kt)("inlineCode",{parentName:"p"},"LoginRequestBody")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"LoginRequestBody = {\n    username: '',\n    password: '',\n    applicationname: ''\n  };\n")),(0,r.kt)("p",null,"Cet objet doit contenir les donn\xe9es du formulaire."),(0,r.kt)("p",null,"Le nom de l\u2019application n\u2019est pas \xe0 utiliser ici, car elle est d\xe9j\xe0 d\xe9finie avant lors de la mise en place dans les routes (voir ci-dessus)"),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Revoir la librairie pour que la m\xe9thode login() ait le nom d\u2019utilisateur et le mot de passe directement en param\xe8tres et non plus un objet LoginRequestBody car c\u2019est ce dernier qui porte le nom de l\u2019application, mais il n\u2019est pas transmis lors de l\u2019appel de la m\xe9thode"))))}d.isMDXComponent=!0}}]);